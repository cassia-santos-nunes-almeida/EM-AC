<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electric & Magnetic Field Interaction - Complete</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 1.1em;
            cursor: pointer;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .visualization-area {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        canvas {
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            display: block;
            margin: 0 auto;
            max-width: 100%;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .control-group {
            margin: 15px 0;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: #d3d3d3;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            margin-left: 10px;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.active {
            background: #2ecc71;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .equation {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            border: 1px solid #ddd;
            text-align: center;
            font-size: 1.1em;
        }

        .equation-dynamic {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%);
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .equation-dynamic h4 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .equation-dynamic .eq-line {
            background: white;
            padding: 10px;
            margin: 8px 0;
            border-radius: 4px;
            font-size: 1em;
            line-height: 1.6;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 30px;
            height: 4px;
            border-radius: 2px;
        }

        .view-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Electromagnetic Field Explorer</h1>
            <p>Interactive visualization of electric and magnetic field relationships</p>
        </div>

        <div class="content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('wave')">EM Wave</button>
                <button class="tab" onclick="switchTab('maxwells')">Maxwell's Equations</button>
                <button class="tab" onclick="switchTab('faraday')">Faraday's Law</button>
                <button class="tab" onclick="switchTab('ampere')">Amp√®re's Law</button>
            </div>

            <!-- EM Wave Tab -->
            <div id="wave" class="tab-content active">
                <div class="info-box">
                    <h3>Electromagnetic Wave Propagation</h3>
                    <p>In an electromagnetic wave, the electric field (E) and magnetic field (B) oscillate perpendicular to each other and to the direction of propagation. The wave travels at the speed of light (c = 3√ó10‚Å∏ m/s).</p>
                </div>

                <div class="equation">
                    c = 1 / ‚àö(Œº‚ÇÄŒµ‚ÇÄ) ‚âà 3√ó10‚Å∏ m/s  |  E = cB
                </div>

                <!-- View Selection -->
                <div class="view-buttons">
                    <button id="view2d" class="active" onclick="setView('2d')">üìä 2D Side View</button>
                    <button id="view3d" onclick="setView('3d')">üé≤ 3D Perspective</button>
                    <button id="viewVI" onclick="setView('vi')">‚ö° Voltage & Current</button>
                </div>

                <!-- Dynamic Equations Display -->
                <div class="equation-dynamic" id="dynamicEquations">
                    <h4 id="eqTitle">üìê Current Wave Equations:</h4>
                    <div class="eq-line" id="eqGeneral">General form: y = A¬∑sin(2œÄft + œÜ)</div>
                    <div class="eq-line" id="eqElectric">E(x,t) = <span id="eqE">1.00</span> V/m ¬∑ sin(2œÄ ¬∑ <span id="eqF">1.0</span> Hz ¬∑ t - kx)</div>
                    <div class="eq-line" id="eqMagnetic">B(x,t) = <span id="eqB">3.33e-9</span> T ¬∑ sin(2œÄ ¬∑ <span id="eqF2">1.0</span> Hz ¬∑ t - kx)</div>
                    <div class="eq-line" id="eqVoltage" style="display:none;">
                        V(t) = <span id="eqV">1.00</span> V ¬∑ sin(2œÄ ¬∑ <span id="eqFV">1.0</span> Hz ¬∑ t + <span id="eqPhaseVDeg">0</span>¬∞) 
                        &nbsp;&nbsp;[Phase: <span id="eqPhaseVRad">0.000</span> rad]
                    </div>
                    <div class="eq-line" id="eqCurrent" style="display:none;">
                        I(t) = <span id="eqI">1.00</span> A ¬∑ sin(2œÄ ¬∑ <span id="eqFI">1.0</span> Hz ¬∑ t + <span id="eqPhaseIDeg">0</span>¬∞)
                        &nbsp;&nbsp;[Phase: <span id="eqPhaseIRad">0.000</span> rad]
                    </div>
                    <div class="eq-line" id="eqPower" style="display:none;">
                        P(t) = V(t) √ó I(t) = <span id="eqPowerCalc">...</span>
                    </div>
                    <div class="eq-line" id="eqPeriod">
                        Period T = <span id="eqT">1.00</span> s  |  Wavelength Œª = c/f = <span id="eqLambda">3.00√ó10‚Å∏</span> m
                    </div>
                    <div class="eq-line" id="eqPhaseInfo" style="display:none;">
                        Phase Difference: ŒîœÜ = <span id="eqPhaseDiff">0</span>¬∞ <span id="eqPhaseType"></span>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label>Frequency (Hz): <span class="value-display" id="freqValue">1.0</span></label>
                        <input type="range" id="frequency" min="0.1" max="5" step="0.1" value="1">
                    </div>
                    <div class="control-group" id="ampControl">
                        <label>Amplitude: <span class="value-display" id="ampValue">1.0</span></label>
                        <input type="range" id="amplitude" min="0.1" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group">
                        <label>Wave Speed: <span class="value-display" id="speedValue">1.0</span></label>
                        <input type="range" id="waveSpeed" min="0.1" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group" id="ampControlV" style="display:none;">
                        <label>Voltage Amplitude (V): <span class="value-display" id="ampVValue">1.0</span></label>
                        <input type="range" id="amplitudeV" min="0.1" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group" id="ampControlI" style="display:none;">
                        <label>Current Amplitude (A): <span class="value-display" id="ampIValue">1.0</span></label>
                        <input type="range" id="amplitudeI" min="0.1" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group" id="phaseControlV" style="display:none;">
                        <label>Voltage Phase (degrees): <span class="value-display" id="phaseVValue">0¬∞</span></label>
                        <input type="range" id="phaseV" min="-180" max="180" step="5" value="0">
                    </div>
                    <div class="control-group" id="phaseControlI" style="display:none;">
                        <label>Current Phase (degrees): <span class="value-display" id="phaseIValue">0¬∞</span></label>
                        <input type="range" id="phaseI" min="-180" max="180" step="5" value="0">
                    </div>
                    <button onclick="toggleAnimation()">‚è∏ Pause/Play</button>
                    <button onclick="resetWave()">üîÑ Reset</button>
                </div>

                <div class="legend" id="legend2d">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c; height: 8px;"></div>
                        <span>Electric Field (E)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db; height: 8px;"></div>
                        <span>Magnetic Field (B)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #2ecc71; height: 8px;"></div>
                        <span>Propagation Direction</span>
                    </div>
                </div>

                <div class="legend" id="legendVI" style="display:none;">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c; height: 8px;"></div>
                        <span>Voltage (V)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db; height: 8px;"></div>
                        <span>Current (I)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #9b59b6; height: 8px;"></div>
                        <span>Power (P = V√óI)</span>
                    </div>
                </div>

                <div class="visualization-area">
                    <canvas id="waveCanvas" width="900" height="600"></canvas>
                </div>
            </div>

            <!-- Maxwell's Equations Tab -->
            <div id="maxwells" class="tab-content">
                <div class="info-box">
                    <h3>Maxwell's Equations</h3>
                    <p>These four fundamental equations describe how electric and magnetic fields are generated and altered by charges, currents, and changes in the fields themselves.</p>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3>1. Gauss's Law (Electric)</h3>
                        <div class="equation">‚àá¬∑E = œÅ/Œµ‚ÇÄ</div>
                        <p>Electric field divergence relates to charge density. Electric field lines originate from positive charges and terminate on negative charges.</p>
                    </div>

                    <div class="card">
                        <h3>2. Gauss's Law (Magnetic)</h3>
                        <div class="equation">‚àá¬∑B = 0</div>
                        <p>Magnetic field has zero divergence. There are no magnetic monopoles - magnetic field lines always form closed loops.</p>
                    </div>

                    <div class="card">
                        <h3>3. Faraday's Law</h3>
                        <div class="equation">‚àá√óE = -‚àÇB/‚àÇt</div>
                        <p>A changing magnetic field induces a curling electric field. This is the principle behind electromagnetic induction.</p>
                    </div>

                    <div class="card">
                        <h3>4. Amp√®re-Maxwell Law</h3>
                        <div class="equation">‚àá√óB = Œº‚ÇÄJ + Œº‚ÇÄŒµ‚ÇÄ‚àÇE/‚àÇt</div>
                        <p>Magnetic fields are generated by electric currents and changing electric fields (displacement current).</p>
                    </div>
                </div>

                <div class="visualization-area">
                    <canvas id="maxwellCanvas" width="800" height="400"></canvas>
                </div>
            </div>

            <!-- Faraday's Law Tab -->
            <div id="faraday" class="tab-content">
                <div class="info-box">
                    <h3>Faraday's Law of Electromagnetic Induction</h3>
                    <p>A changing magnetic flux through a loop induces an electromotive force (EMF) that creates an electric field.</p>
                </div>

                <div class="equation">
                    Œµ = -dŒ¶_B/dt = -d/dt(‚à´B¬∑dA)
                </div>

                <div class="equation">
                    ‚àÆE¬∑dl = -dŒ¶_B/dt
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label>Magnetic Field Change Rate: <span class="value-display" id="bRateValue">1.0</span></label>
                        <input type="range" id="bChangeRate" min="0.1" max="3" step="0.1" value="1">
                    </div>
                    <button onclick="toggleFaraday()">‚è∏ Pause/Play</button>
                    <button onclick="resetFaraday()">üîÑ Reset</button>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db; height: 8px;"></div>
                        <span>Magnetic Field (B) - into/out of page</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c; height: 8px;"></div>
                        <span>Induced Electric Field (E)</span>
                    </div>
                </div>

                <div class="visualization-area">
                    <canvas id="faradayCanvas" width="800" height="500"></canvas>
                </div>

                <div class="info-box">
                    <h3>Key Concept</h3>
                    <p>The negative sign (Lenz's Law) indicates that the induced electric field opposes the change in magnetic flux. When B increases (‚äô), the induced E field circulates to create a B field opposing the increase (‚äó).</p>
                </div>
            </div>

            <!-- Amp√®re's Law Tab -->
            <div id="ampere" class="tab-content">
                <div class="info-box">
                    <h3>Amp√®re-Maxwell Law</h3>
                    <p>Magnetic fields circulate around electric currents AND changing electric fields. Maxwell added the displacement current term (‚àÇE/‚àÇt) to complete the symmetry with Faraday's law.</p>
                </div>

                <div class="equation">
                    ‚àÆB¬∑dl = Œº‚ÇÄI + Œº‚ÇÄŒµ‚ÇÄdŒ¶_E/dt
                </div>

                <div class="equation">
                    ‚àá√óB = Œº‚ÇÄJ + Œº‚ÇÄŒµ‚ÇÄ‚àÇE/‚àÇt
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label>Current: <span class="value-display" id="currentValue">1.0</span></label>
                        <input type="range" id="current" min="0" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group">
                        <label>Electric Field Change: <span class="value-display" id="eRateValue">0.5</span></label>
                        <input type="range" id="eChangeRate" min="0" max="2" step="0.1" value="0.5">
                    </div>
                    <button onclick="toggleAmpere()">‚è∏ Pause/Play</button>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c; height: 8px;"></div>
                        <span>Electric Field (E)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db; height: 8px;"></div>
                        <span>Magnetic Field (B)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f39c12; height: 8px;"></div>
                        <span>Current (I)</span>
                    </div>
                </div>

                <div class="visualization-area">
                    <canvas id="ampereCanvas" width="800" height="500"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global animation state
        let animationRunning = true;
        let currentView = '2d';
        let time = 0;
        let frequency = 1;
        let amplitude = 1;
        let amplitudeV = 1;
        let amplitudeI = 1;
        let waveSpeed = 1;
        let phaseV = 0;
        let phaseI = 0;

        // Tab switching
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // View switching
        function setView(view) {
            currentView = view;
            
            // Update button states
            document.getElementById('view2d').classList.remove('active');
            document.getElementById('view3d').classList.remove('active');
            document.getElementById('viewVI').classList.remove('active');
            
            if (view === '2d') {
                document.getElementById('view2d').classList.add('active');
                document.getElementById('eqTitle').textContent = 'üìê Current Wave Equations:';
                document.getElementById('legend2d').style.display = 'flex';
                document.getElementById('legendVI').style.display = 'none';
                document.getElementById('ampControl').style.display = 'block';
                document.getElementById('ampControlV').style.display = 'none';
                document.getElementById('ampControlI').style.display = 'none';
                document.getElementById('phaseControlV').style.display = 'none';
                document.getElementById('phaseControlI').style.display = 'none';
                document.getElementById('eqGeneral').style.display = 'block';
                document.getElementById('eqElectric').style.display = 'block';
                document.getElementById('eqMagnetic').style.display = 'block';
                document.getElementById('eqVoltage').style.display = 'none';
                document.getElementById('eqCurrent').style.display = 'none';
                document.getElementById('eqPower').style.display = 'none';
                document.getElementById('eqPhaseInfo').style.display = 'none';
                document.getElementById('eqPeriod').innerHTML = 'Period T = <span id="eqT">1.00</span> s  |  Wavelength Œª = c/f = <span id="eqLambda">3.00√ó10‚Å∏</span> m';
            } else if (view === '3d') {
                document.getElementById('view3d').classList.add('active');
                document.getElementById('eqTitle').textContent = 'üìê Current Wave Equations (3D):';
                document.getElementById('legend2d').style.display = 'flex';
                document.getElementById('legendVI').style.display = 'none';
                document.getElementById('ampControl').style.display = 'block';
                document.getElementById('ampControlV').style.display = 'none';
                document.getElementById('ampControlI').style.display = 'none';
                document.getElementById('phaseControlV').style.display = 'none';
                document.getElementById('phaseControlI').style.display = 'none';
                document.getElementById('eqGeneral').style.display = 'block';
                document.getElementById('eqElectric').style.display = 'block';
                document.getElementById('eqMagnetic').style.display = 'block';
                document.getElementById('eqVoltage').style.display = 'none';
                document.getElementById('eqCurrent').style.display = 'none';
                document.getElementById('eqPower').style.display = 'none';
                document.getElementById('eqPhaseInfo').style.display = 'none';
                document.getElementById('eqPeriod').innerHTML = 'Period T = <span id="eqT">1.00</span> s  |  Wavelength Œª = c/f = <span id="eqLambda">3.00√ó10‚Å∏</span> m';
            } else if (view === 'vi') {
                document.getElementById('viewVI').classList.add('active');
                document.getElementById('eqTitle').textContent = 'üìê Voltage & Current Equations:';
                document.getElementById('legend2d').style.display = 'none';
                document.getElementById('legendVI').style.display = 'flex';
                document.getElementById('ampControl').style.display = 'none';
                document.getElementById('ampControlV').style.display = 'block';
                document.getElementById('ampControlI').style.display = 'block';
                document.getElementById('phaseControlV').style.display = 'block';
                document.getElementById('phaseControlI').style.display = 'block';
                document.getElementById('eqGeneral').style.display = 'block';
                document.getElementById('eqElectric').style.display = 'none';
                document.getElementById('eqMagnetic').style.display = 'none';
                document.getElementById('eqVoltage').style.display = 'block';
                document.getElementById('eqCurrent').style.display = 'block';
                document.getElementById('eqPower').style.display = 'block';
                document.getElementById('eqPhaseInfo').style.display = 'block';
                document.getElementById('eqPeriod').innerHTML = 'Period T = <span id="eqT">1.00</span> s  |  Frequency f = <span id="eqFreq">1.00</span> Hz';
            }
            
            updateEquations();
        }

        // Update equations display
        function updateEquations() {
            const period = 1 / frequency;
            const wavelength = 3e8 / frequency;
            const bAmplitude = amplitude / 3e8;
            
            if (document.getElementById('eqE')) {
                document.getElementById('eqE').textContent = amplitude.toFixed(2);
            }
            if (document.getElementById('eqF')) {
                document.getElementById('eqF').textContent = frequency.toFixed(1);
            }
            if (document.getElementById('eqF2')) {
                document.getElementById('eqF2').textContent = frequency.toFixed(1);
            }
            if (document.getElementById('eqB')) {
                document.getElementById('eqB').textContent = bAmplitude.toExponential(2);
            }
            if (document.getElementById('eqT')) {
                document.getElementById('eqT').textContent = period.toFixed(2);
            }
            
            if (currentView !== 'vi' && document.getElementById('eqLambda')) {
                document.getElementById('eqLambda').textContent = wavelength.toExponential(2);
            }
            
            if (currentView === 'vi') {
                if (document.getElementById('eqFreq')) {
                    document.getElementById('eqFreq').textContent = frequency.toFixed(2);
                }
                
                if (document.getElementById('eqV')) {
                    document.getElementById('eqV').textContent = amplitudeV.toFixed(2);
                }
                if (document.getElementById('eqFV')) {
                    document.getElementById('eqFV').textContent = frequency.toFixed(1);
                }
                if (document.getElementById('eqPhaseVDeg')) {
                    document.getElementById('eqPhaseVDeg').textContent = phaseV.toFixed(0);
                }
                if (document.getElementById('eqPhaseVRad')) {
                    const phaseVRad = (phaseV * Math.PI / 180);
                    document.getElementById('eqPhaseVRad').textContent = phaseVRad.toFixed(3);
                }
                
                if (document.getElementById('eqI')) {
                    document.getElementById('eqI').textContent = amplitudeI.toFixed(2);
                }
                if (document.getElementById('eqFI')) {
                    document.getElementById('eqFI').textContent = frequency.toFixed(1);
                }
                if (document.getElementById('eqPhaseIDeg')) {
                    document.getElementById('eqPhaseIDeg').textContent = phaseI.toFixed(0);
                }
                if (document.getElementById('eqPhaseIRad')) {
                    const phaseIRad = (phaseI * Math.PI / 180);
                    document.getElementById('eqPhaseIRad').textContent = phaseIRad.toFixed(3);
                }
                
                const phaseDiff = phaseI - phaseV;
                if (document.getElementById('eqPhaseDiff')) {
                    document.getElementById('eqPhaseDiff').textContent = phaseDiff.toFixed(0);
                }
                
                let phaseType = '';
                if (Math.abs(phaseDiff) < 5) {
                    phaseType = '(In Phase - Resistive Load)';
                } else if (Math.abs(Math.abs(phaseDiff) - 90) < 5) {
                    phaseType = '(90¬∞ - Purely Reactive)';
                } else if (Math.abs(Math.abs(phaseDiff) - 180) < 5) {
                    phaseType = '(180¬∞ - Opposite Phase)';
                } else if (phaseDiff > 0 && phaseDiff < 90) {
                    phaseType = '(Current Leads - Capacitive)';
                } else if (phaseDiff < 0 && phaseDiff > -90) {
                    phaseType = '(Current Lags - Inductive)';
                } else if (phaseDiff > 90) {
                    phaseType = '(Current Leads > 90¬∞)';
                } else if (phaseDiff < -90) {
                    phaseType = '(Current Lags > 90¬∞)';
                }
                if (document.getElementById('eqPhaseType')) {
                    document.getElementById('eqPhaseType').textContent = phaseType;
                }
                
                const AvAi = amplitudeV * amplitudeI / 2;
                const phaseSum = phaseV + phaseI;
                
                if (document.getElementById('eqPowerCalc')) {
                    document.getElementById('eqPowerCalc').textContent = 
                        `${AvAi.toFixed(2)}¬∑[cos(${phaseDiff.toFixed(0)}¬∞) - cos(4œÄ¬∑${frequency.toFixed(1)}¬∑t + ${phaseSum.toFixed(0)}¬∞)]`;
                }
            }
        }

        // Event listeners
        document.getElementById('frequency').addEventListener('input', (e) => {
            frequency = parseFloat(e.target.value);
            document.getElementById('freqValue').textContent = frequency.toFixed(1);
            updateEquations();
        });

        document.getElementById('amplitude').addEventListener('input', (e) => {
            amplitude = parseFloat(e.target.value);
            document.getElementById('ampValue').textContent = amplitude.toFixed(1);
            updateEquations();
        });

        document.getElementById('waveSpeed').addEventListener('input', (e) => {
            waveSpeed = parseFloat(e.target.value);
            document.getElementById('speedValue').textContent = waveSpeed.toFixed(1);
        });

        document.getElementById('amplitudeV').addEventListener('input', (e) => {
            amplitudeV = parseFloat(e.target.value);
            document.getElementById('ampVValue').textContent = amplitudeV.toFixed(1);
            updateEquations();
        });

        document.getElementById('amplitudeI').addEventListener('input', (e) => {
            amplitudeI = parseFloat(e.target.value);
            document.getElementById('ampIValue').textContent = amplitudeI.toFixed(1);
            updateEquations();
        });

        document.getElementById('phaseV').addEventListener('input', (e) => {
            phaseV = parseFloat(e.target.value);
            document.getElementById('phaseVValue').textContent = phaseV.toFixed(0) + '¬∞';
            updateEquations();
        });

        document.getElementById('phaseI').addEventListener('input', (e) => {
            phaseI = parseFloat(e.target.value);
            document.getElementById('phaseIValue').textContent = phaseI.toFixed(0) + '¬∞';
            updateEquations();
        });

        // Canvas and drawing
        const waveCanvas = document.getElementById('waveCanvas');
        const waveCtx = waveCanvas.getContext('2d');

        function drawWave() {
            if (currentView === '2d') {
                draw2DWave();
            } else if (currentView === '3d') {
                draw3DWave();
            } else if (currentView === 'vi') {
                drawVIWave();
            }
            
            if (animationRunning) {
                time += 0.05;
            }
            requestAnimationFrame(drawWave);
        }

        function draw2DWave() {
            const width = waveCanvas.width;
            const height = waveCanvas.height;
            const centerY = height / 2;
            
            waveCtx.clearRect(0, 0, width, height);
            
            waveCtx.strokeStyle = '#ddd';
            waveCtx.lineWidth = 1;
            waveCtx.beginPath();
            waveCtx.moveTo(0, centerY);
            waveCtx.lineTo(width, centerY);
            waveCtx.stroke();
            
            waveCtx.fillStyle = '#2ecc71';
            waveCtx.font = 'bold 16px Arial';
            waveCtx.fillText('‚Üí Propagation Direction (x-axis)', width - 320, 30);
            
            waveCtx.strokeStyle = '#e74c3c';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let x = 0; x < width; x++) {
                const t = time * waveSpeed;
                const y = centerY + amplitude * 80 * Math.sin(frequency * 0.02 * x - t);
                if (x === 0) {
                    waveCtx.moveTo(x, y);
                } else {
                    waveCtx.lineTo(x, y);
                }
            }
            waveCtx.stroke();
            
            for (let x = 50; x < width; x += 100) {
                const t = time * waveSpeed;
                const eY = centerY + amplitude * 80 * Math.sin(frequency * 0.02 * x - t);
                drawArrow(waveCtx, x, centerY, x, eY, '#e74c3c');
            }
            
            const zOffset = 150;
            waveCtx.strokeStyle = '#3498db';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let x = 0; x < width; x++) {
                const t = time * waveSpeed;
                const z = centerY + zOffset + amplitude * 80 * Math.sin(frequency * 0.02 * x - t);
                if (x === 0) {
                    waveCtx.moveTo(x, z);
                } else {
                    waveCtx.lineTo(x, z);
                }
            }
            waveCtx.stroke();
            
            for (let x = 50; x < width; x += 100) {
                const t = time * waveSpeed;
                const bY = centerY + zOffset + amplitude * 80 * Math.sin(frequency * 0.02 * x - t);
                drawArrow(waveCtx, x, centerY + zOffset, x, bY, '#3498db');
            }
            
            waveCtx.fillStyle = '#e74c3c';
            waveCtx.font = 'bold 20px Arial';
            waveCtx.fillText('E (y-axis)', 20, centerY - 100);
            
            waveCtx.fillStyle = '#3498db';
            waveCtx.fillText('B (z-axis)', 20, centerY + zOffset - 100);
        }

        function draw3DWave() {
            const width = waveCanvas.width;
            const height = waveCanvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            
            waveCtx.clearRect(0, 0, width, height);
            
            const rotationY = Math.PI / 6;
            const rotationX = Math.PI / 12;
            
            waveCtx.strokeStyle = '#999';
            waveCtx.lineWidth = 2;
            
            const xAxis = project3D(-300, 0, 0, rotationY, rotationX);
            const xAxisEnd = project3D(300, 0, 0, rotationY, rotationX);
            waveCtx.beginPath();
            waveCtx.moveTo(centerX + xAxis.x, centerY + xAxis.y);
            waveCtx.lineTo(centerX + xAxisEnd.x, centerY + xAxisEnd.y);
            waveCtx.stroke();
            waveCtx.fillStyle = '#2ecc71';
            waveCtx.font = 'bold 16px Arial';
            waveCtx.fillText('x', centerX + xAxisEnd.x + 10, centerY + xAxisEnd.y);
            
            const yAxis = project3D(0, -150, 0, rotationY, rotationX);
            const yAxisEnd = project3D(0, 150, 0, rotationY, rotationX);
            waveCtx.beginPath();
            waveCtx.moveTo(centerX + yAxis.x, centerY + yAxis.y);
            waveCtx.lineTo(centerX + yAxisEnd.x, centerY + yAxisEnd.y);
            waveCtx.stroke();
            waveCtx.fillStyle = '#e74c3c';
            waveCtx.fillText('y (E)', centerX + yAxisEnd.x - 30, centerY + yAxisEnd.y - 10);
            
            const zAxis = project3D(0, 0, -150, rotationY, rotationX);
            const zAxisEnd = project3D(0, 0, 150, rotationY, rotationX);
            waveCtx.beginPath();
            waveCtx.moveTo(centerX + zAxis.x, centerY + zAxis.y);
            waveCtx.lineTo(centerX + zAxisEnd.x, centerY + zAxisEnd.y);
            waveCtx.stroke();
            waveCtx.fillStyle = '#3498db';
            waveCtx.fillText('z (B)', centerX + zAxisEnd.x + 10, centerY + zAxisEnd.y);
            
            waveCtx.strokeStyle = '#e74c3c';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let i = -150; i <= 150; i += 2) {
                const x = i;
                const t = time * waveSpeed;
                const y = amplitude * 80 * Math.sin(frequency * 0.02 * (i + 150) - t);
                const z = 0;
                const proj = project3D(x, y, z, rotationY, rotationX);
                
                if (i === -150) {
                    waveCtx.moveTo(centerX + proj.x, centerY + proj.y);
                } else {
                    waveCtx.lineTo(centerX + proj.x, centerY + proj.y);
                }
            }
            waveCtx.stroke();
            
            waveCtx.strokeStyle = '#3498db';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let i = -150; i <= 150; i += 2) {
                const x = i;
                const t = time * waveSpeed;
                const y = 0;
                const z = amplitude * 80 * Math.sin(frequency * 0.02 * (i + 150) - t);
                const proj = project3D(x, y, z, rotationY, rotationX);
                
                if (i === -150) {
                    waveCtx.moveTo(centerX + proj.x, centerY + proj.y);
                } else {
                    waveCtx.lineTo(centerX + proj.x, centerY + proj.y);
                }
            }
            waveCtx.stroke();
            
            for (let i = -150; i <= 150; i += 50) {
                const x = i;
                const t = time * waveSpeed;
                
                const eY = amplitude * 80 * Math.sin(frequency * 0.02 * (i + 150) - t);
                const projE1 = project3D(x, 0, 0, rotationY, rotationX);
                const projE2 = project3D(x, eY, 0, rotationY, rotationX);
                drawArrow3D(waveCtx, centerX + projE1.x, centerY + projE1.y, 
                           centerX + projE2.x, centerY + projE2.y, '#e74c3c');
                
                const bZ = amplitude * 80 * Math.sin(frequency * 0.02 * (i + 150) - t);
                const projB1 = project3D(x, 0, 0, rotationY, rotationX);
                const projB2 = project3D(x, 0, bZ, rotationY, rotationX);
                drawArrow3D(waveCtx, centerX + projB1.x, centerY + projB1.y,
                           centerX + projB2.x, centerY + projB2.y, '#3498db');
            }
            
            waveCtx.fillStyle = '#333';
            waveCtx.font = 'bold 18px Arial';
            waveCtx.fillText('3D Electromagnetic Wave', 20, 30);
        }

        function project3D(x, y, z, rotY, rotX) {
            let newX = x * Math.cos(rotY) - z * Math.sin(rotY);
            let newZ = x * Math.sin(rotY) + z * Math.cos(rotY);
            
            let newY = y * Math.cos(rotX) - newZ * Math.sin(rotX);
            newZ = y * Math.sin(rotX) + newZ * Math.cos(rotX);
            
            return { x: newX, y: newY };
        }

        function drawVIWave() {
            const width = waveCanvas.width;
            const height = waveCanvas.height;
            const centerY = height / 2;
            
            waveCtx.clearRect(0, 0, width, height);
            
            waveCtx.strokeStyle = '#f0f0f0';
            waveCtx.lineWidth = 1;
            for (let y = 0; y < height; y += 50) {
                waveCtx.beginPath();
                waveCtx.moveTo(0, y);
                waveCtx.lineTo(width, y);
                waveCtx.stroke();
            }
            
            waveCtx.strokeStyle = '#999';
            waveCtx.lineWidth = 2;
            waveCtx.beginPath();
            waveCtx.moveTo(0, centerY);
            waveCtx.lineTo(width, centerY);
            waveCtx.stroke();
            
            waveCtx.fillStyle = '#333';
            waveCtx.font = 'bold 16px Arial';
            waveCtx.fillText('Time ‚Üí', width - 80, centerY + 20);
            
            const phaseVRad = phaseV * Math.PI / 180;
            const phaseIRad = phaseI * Math.PI / 180;
            
            waveCtx.strokeStyle = '#e74c3c';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let x = 0; x < width; x++) {
                const t = time * waveSpeed + x * 0.01;
                const v = centerY - amplitudeV * 120 * Math.sin(frequency * t + phaseVRad);
                if (x === 0) {
                    waveCtx.moveTo(x, v);
                } else {
                    waveCtx.lineTo(x, v);
                }
            }
            waveCtx.stroke();
            
            waveCtx.strokeStyle = '#3498db';
            waveCtx.lineWidth = 3;
            waveCtx.beginPath();
            
            for (let x = 0; x < width; x++) {
                const t = time * waveSpeed + x * 0.01;
                const i = centerY - amplitudeI * 120 * Math.sin(frequency * t + phaseIRad);
                if (x === 0) {
                    waveCtx.moveTo(x, i);
                } else {
                    waveCtx.lineTo(x, i);
                }
            }
            waveCtx.stroke();
            
            waveCtx.strokeStyle = '#9b59b6';
            waveCtx.lineWidth = 2;
            waveCtx.setLineDash([5, 5]);
            waveCtx.beginPath();
            
            for (let x = 0; x < width; x++) {
                const t = time * waveSpeed + x * 0.01;
                const v = Math.sin(frequency * t + phaseVRad);
                const i = Math.sin(frequency * t + phaseIRad);
                const p = centerY - (v * i) * 100 * amplitudeV * amplitudeI;
                if (x === 0) {
                    waveCtx.moveTo(x, p);
                } else {
                    waveCtx.lineTo(x, p);
                }
            }
            waveCtx.stroke();
            waveCtx.setLineDash([]);
            
            const currentX = width / 3;
            const t = time * waveSpeed + currentX * 0.01;
            const vCurrent = centerY - amplitudeV * 120 * Math.sin(frequency * t + phaseVRad);
            const iCurrent = centerY - amplitudeI * 120 * Math.sin(frequency * t + phaseIRad);
            
            waveCtx.fillStyle = '#e74c3c';
            waveCtx.beginPath();
            waveCtx.arc(currentX, vCurrent, 6, 0, Math.PI * 2);
            waveCtx.fill();
            
            waveCtx.fillStyle = '#3498db';
            waveCtx.beginPath();
            waveCtx.arc(currentX, iCurrent, 6, 0, Math.PI * 2);
            waveCtx.fill();
            
            waveCtx.fillStyle = '#e74c3c';
            waveCtx.font = 'bold 18px Arial';
            waveCtx.fillText('Voltage (V)', 20, 30);
            
            waveCtx.fillStyle = '#3498db';
            waveCtx.fillText('Current (I)', 20, 55);
            
            waveCtx.fillStyle = '#9b59b6';
            waveCtx.fillText('Power (P = V √ó I)', 20, 80);
            
            const phaseDiff = phaseI - phaseV;
            waveCtx.fillStyle = '#333';
            waveCtx.font = '14px Arial';
            let phaseText = '';
            if (Math.abs(phaseDiff) < 5) {
                phaseText = 'In Phase - Maximum Power Transfer';
            } else if (Math.abs(Math.abs(phaseDiff) - 90) < 5) {
                phaseText = '90¬∞ Phase Shift - Reactive Power (No Real Power)';
            } else if (Math.abs(Math.abs(phaseDiff) - 180) < 5) {
                phaseText = '180¬∞ Out of Phase - Power Flows Backward';
            } else if (phaseDiff > 0) {
                phaseText = `Current leads Voltage by ${phaseDiff.toFixed(0)}¬∞ (Capacitive)`;
            } else {
                phaseText = `Current lags Voltage by ${(-phaseDiff).toFixed(0)}¬∞ (Inductive)`;
            }
            waveCtx.fillText(phaseText, width - 450, height - 20);
        }

        function drawArrow(ctx, x1, y1, x2, y2, color) {
            const headlen = 10;
            const dx = x2 - x1;
            const dy = y2 - y1;
            const angle = Math.atan2(dy, dx);
            
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - headlen * Math.cos(angle - Math.PI / 6), y2 - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(x2 - headlen * Math.cos(angle + Math.PI / 6), y2 - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fill();
        }

        function drawArrow3D(ctx, x1, y1, x2, y2, color) {
            const headlen = 8;
            const dx = x2 - x1;
            const dy = y2 - y1;
            const angle = Math.atan2(dy, dx);
            
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - headlen * Math.cos(angle - Math.PI / 6), y2 - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(x2 - headlen * Math.cos(angle + Math.PI / 6), y2 - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fill();
        }

        function toggleAnimation() {
            animationRunning = !animationRunning;
        }

        function resetWave() {
            time = 0;
        }

        // Maxwell's Equations Visualization
        const maxwellCanvas = document.getElementById('maxwellCanvas');
        const maxwellCtx = maxwellCanvas.getContext('2d');
        let maxwellTime = 0;

        function drawMaxwell() {
            const width = maxwellCanvas.width;
            const height = maxwellCanvas.height;
            
            maxwellCtx.clearRect(0, 0, width, height);
            
            const quadW = width / 2;
            const quadH = height / 2;
            
            maxwellCtx.save();
            drawGaussElectric(maxwellCtx, quadW / 2, quadH / 2, quadW, quadH);
            maxwellCtx.restore();
            
            maxwellCtx.save();
            maxwellCtx.translate(quadW, 0);
            drawGaussMagnetic(maxwellCtx, quadW / 2, quadH / 2, quadW, quadH);
            maxwellCtx.restore();
            
            maxwellCtx.save();
            maxwellCtx.translate(0, quadH);
            drawFaradaySimple(maxwellCtx, quadW / 2, quadH / 2, quadW, quadH, maxwellTime);
            maxwellCtx.restore();
            
            maxwellCtx.save();
            maxwellCtx.translate(quadW, quadH);
            drawAmpereSimple(maxwellCtx, quadW / 2, quadH / 2, quadW, quadH, maxwellTime);
            maxwellCtx.restore();
            
            maxwellCtx.strokeStyle = '#ccc';
            maxwellCtx.lineWidth = 2;
            maxwellCtx.beginPath();
            maxwellCtx.moveTo(quadW, 0);
            maxwellCtx.lineTo(quadW, height);
            maxwellCtx.moveTo(0, quadH);
            maxwellCtx.lineTo(width, quadH);
            maxwellCtx.stroke();
            
            if (animationRunning) {
                maxwellTime += 0.02;
            }
            requestAnimationFrame(drawMaxwell);
        }

        function drawGaussElectric(ctx, cx, cy, w, h) {
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(cx, cy, 15, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('+', cx, cy);
            
            for (let angle = 0; angle < Math.PI * 2; angle += Math.PI / 8) {
                const x1 = cx + 20 * Math.cos(angle);
                const y1 = cy + 20 * Math.sin(angle);
                const x2 = cx + 60 * Math.cos(angle);
                const y2 = cy + 60 * Math.sin(angle);
                drawArrow(ctx, x1, y1, x2, y2, '#e74c3c');
            }
            
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('‚àá¬∑E = œÅ/Œµ‚ÇÄ', cx, h - 20);
        }

        function drawGaussMagnetic(ctx, cx, cy, w, h) {
            const r = 50;
            
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.ellipse(cx, cy - 15, r, 30, 0, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.ellipse(cx, cy + 15, r, 30, 0, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(cx, cy - 25, 10, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(cx, cy + 25, 10, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('N', cx, cy - 25);
            ctx.fillText('S', cx, cy + 25);
            
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('‚àá¬∑B = 0', cx, h - 20);
        }

        function drawFaradaySimple(ctx, cx, cy, w, h, t) {
            const bStrength = Math.sin(t);
            
            ctx.fillStyle = bStrength > 0 ? '#3498db' : '#3498db';
            ctx.beginPath();
            ctx.arc(cx, cy, 30, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(bStrength > 0 ? '‚äô' : '‚äó', cx, cy);
            
            const radius = 60;
            for (let angle = 0; angle < Math.PI * 2; angle += Math.PI / 4) {
                const x1 = cx + radius * Math.cos(angle);
                const y1 = cy + radius * Math.sin(angle);
                const x2 = cx + radius * Math.cos(angle + 0.3);
                const y2 = cy + radius * Math.sin(angle + 0.3);
                drawArrow(ctx, x1, y1, x2, y2, '#e74c3c');
            }
            
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('‚àá√óE = -‚àÇB/‚àÇt', cx, h - 20);
        }

        function drawAmpereSimple(ctx, cx, cy, w, h, t) {
            ctx.fillStyle = '#f39c12';
            ctx.fillRect(cx - 5, cy - 60, 10, 120);
            
            drawArrow(ctx, cx, cy + 50, cx, cy - 50, '#f39c12');
            
            ctx.fillStyle = '#f39c12';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('I', cx + 20, cy);
            
            const radius = 50;
            for (let angle = 0; angle < Math.PI * 2; angle += Math.PI / 4) {
                const x1 = cx + radius * Math.cos(angle);
                const y1 = cy + radius * Math.sin(angle);
                const x2 = cx + radius * Math.cos(angle + 0.3);
                const y2 = cy + radius * Math.sin(angle + 0.3);
                drawArrow(ctx, x1, y1, x2, y2, '#3498db');
            }
            
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('‚àá√óB = Œº‚ÇÄJ + Œº‚ÇÄŒµ‚ÇÄ‚àÇE/‚àÇt', cx, h - 20);
        }

        // Faraday's Law Detailed Visualization
        const faradayCanvas = document.getElementById('faradayCanvas');
        const faradayCtx = faradayCanvas.getContext('2d');
        let faradayTime = 0;
        let faradayRunning = true;
        let bChangeRate = 1;

        document.getElementById('bChangeRate').addEventListener('input', (e) => {
            bChangeRate = parseFloat(e.target.value);
            document.getElementById('bRateValue').textContent = bChangeRate.toFixed(1);
        });

        function drawFaradayDetail() {
            const width = faradayCanvas.width;
            const height = faradayCanvas.height;
            const cx = width / 2;
            const cy = height / 2;
            
            faradayCtx.clearRect(0, 0, width, height);
            
            const bField = Math.sin(faradayTime * bChangeRate);
            const bFieldGrowing = Math.cos(faradayTime * bChangeRate) > 0;
            
            const regionRadius = 120;
            faradayCtx.fillStyle = bField > 0 ? 'rgba(52, 152, 219, 0.2)' : 'rgba(155, 89, 182, 0.2)';
            faradayCtx.beginPath();
            faradayCtx.arc(cx, cy, regionRadius, 0, Math.PI * 2);
            faradayCtx.fill();
            
            const gridSize = 40;
            for (let i = -2; i <= 2; i++) {
                for (let j = -2; j <= 2; j++) {
                    const x = cx + i * gridSize;
                    const y = cy + j * gridSize;
                    const dist = Math.sqrt(i * i + j * j) * gridSize;
                    
                    if (dist < regionRadius) {
                        faradayCtx.fillStyle = '#3498db';
                        faradayCtx.font = 'bold 20px Arial';
                        faradayCtx.textAlign = 'center';
                        faradayCtx.textBaseline = 'middle';
                        faradayCtx.fillText(bField > 0 ? '‚äô' : '‚äó', x, y);
                    }
                }
            }
            
            const eRadius = 150;
            faradayCtx.strokeStyle = '#e74c3c';
            faradayCtx.lineWidth = 3;
            faradayCtx.setLineDash([5, 5]);
            faradayCtx.beginPath();
            faradayCtx.arc(cx, cy, eRadius, 0, Math.PI * 2);
            faradayCtx.stroke();
            faradayCtx.setLineDash([]);
            
            const numArrows = 12;
            for (let i = 0; i < numArrows; i++) {
                const angle = (i / numArrows) * Math.PI * 2;
                const x = cx + eRadius * Math.cos(angle);
                const y = cy + eRadius * Math.sin(angle);
                const direction = bFieldGrowing ? -1 : 1;
                const dx = direction * 30 * Math.sin(angle);
                const dy = direction * -30 * Math.cos(angle);
                drawArrow(faradayCtx, x - dx/2, y - dy/2, x + dx/2, y + dy/2, '#e74c3c');
            }
            
            faradayCtx.fillStyle = '#333';
            faradayCtx.font = 'bold 18px Arial';
            faradayCtx.textAlign = 'center';
            
            faradayCtx.fillStyle = '#3498db';
            faradayCtx.fillText(`B field: ${bField > 0 ? 'INTO page ‚äô' : 'OUT of page ‚äó'}`, cx, 40);
            faradayCtx.fillText(`Magnitude: ${Math.abs(bField).toFixed(2)}`, cx, 65);
            faradayCtx.fillText(`${bFieldGrowing ? 'INCREASING ‚Üë' : 'DECREASING ‚Üì'}`, cx, 90);
            
            faradayCtx.fillStyle = '#e74c3c';
            faradayCtx.fillText(`Induced E field: ${bFieldGrowing ? 'Clockwise ‚Üª' : 'Counter-clockwise ‚Ü∫'}`, cx, height - 30);
            
            if (faradayRunning && animationRunning) {
                faradayTime += 0.03;
            }
            requestAnimationFrame(drawFaradayDetail);
        }

        function toggleFaraday() {
            faradayRunning = !faradayRunning;
        }

        function resetFaraday() {
            faradayTime = 0;
        }

        // Amp√®re's Law Visualization
        const ampereCanvas = document.getElementById('ampereCanvas');
        const ampereCtx = ampereCanvas.getContext('2d');
        let ampereTime = 0;
        let ampereRunning = true;
        let current = 1;
        let eChangeRate = 0.5;

        document.getElementById('current').addEventListener('input', (e) => {
            current = parseFloat(e.target.value);
            document.getElementById('currentValue').textContent = current.toFixed(1);
        });

        document.getElementById('eChangeRate').addEventListener('input', (e) => {
            eChangeRate = parseFloat(e.target.value);
            document.getElementById('eRateValue').textContent = eChangeRate.toFixed(1);
        });

        function drawAmpereDetail() {
            const width = ampereCanvas.width;
            const height = ampereCanvas.height;
            const cx = width / 2;
            const cy = height / 2;
            
            ampereCtx.clearRect(0, 0, width, height);
            
            // Title and explanation
            ampereCtx.fillStyle = '#333';
            ampereCtx.font = 'bold 18px Arial';
            ampereCtx.textAlign = 'center';
            ampereCtx.fillText('Amp√®re\'s Law: Magnetic Field Circulates Around Current', cx, 25);
            
            ampereCtx.fillStyle = '#666';
            ampereCtx.font = '14px Arial';
            ampereCtx.fillText('Top View: Looking DOWN at wire. Current goes INTO page (‚äó). B field circles CLOCKWISE.', cx, 50);
            
            // Draw circular cross-section of wire (viewed from above)
            ampereCtx.fillStyle = '#f39c12';
            ampereCtx.beginPath();
            ampereCtx.arc(cx, cy, 20, 0, Math.PI * 2);
            ampereCtx.fill();
            
            // Draw wire outline
            ampereCtx.strokeStyle = '#d68910';
            ampereCtx.lineWidth = 3;
            ampereCtx.beginPath();
            ampereCtx.arc(cx, cy, 20, 0, Math.PI * 2);
            ampereCtx.stroke();
            
            // Draw current direction symbol (‚äó means into page)
            if (current > 0) {
                ampereCtx.strokeStyle = '#ffffff';
                ampereCtx.lineWidth = 3;
                
                // Draw X symbol (current into page)
                ampereCtx.beginPath();
                ampereCtx.moveTo(cx - 10, cy - 10);
                ampereCtx.lineTo(cx + 10, cy + 10);
                ampereCtx.moveTo(cx + 10, cy - 10);
                ampereCtx.lineTo(cx - 10, cy + 10);
                ampereCtx.stroke();
                
                // Current label
                ampereCtx.fillStyle = '#f39c12';
                ampereCtx.font = 'bold 20px Arial';
                ampereCtx.textAlign = 'left';
                ampereCtx.fillText('I = ' + current.toFixed(1) + ' A', cx + 35, cy - 10);
                ampereCtx.fillText('‚äó (INTO page)', cx + 35, cy + 15);
            }
            
            // Draw magnetic field circles with CLOCKWISE direction (right-hand rule)
            const numCircles = 4;
            for (let i = 1; i <= numCircles; i++) {
                const radius = 40 + i * 55;
                ampereCtx.strokeStyle = i === 1 ? '#2980b9' : '#3498db';
                ampereCtx.lineWidth = i === 1 ? 3 : 2;
                ampereCtx.setLineDash(i === 1 ? [] : [5, 5]);
                ampereCtx.beginPath();
                ampereCtx.arc(cx, cy, radius, 0, Math.PI * 2);
                ampereCtx.stroke();
                ampereCtx.setLineDash([]);
                
                // Draw B field arrows (CLOCKWISE when current goes into page)
                // Right-hand rule: thumb into page, fingers curl clockwise
                const numArrows = 8;
                for (let j = 0; j < numArrows; j++) {
                    const angle = (j / numArrows) * Math.PI * 2;
                    
                    // Position on circle
                    const x1 = cx + radius * Math.cos(angle);
                    const y1 = cy + radius * Math.sin(angle);
                    
                    // For CLOCKWISE rotation, we need to subtract PI/2 (not add)
                    // Tangent perpendicular to radius, rotated 90¬∞ CLOCKWISE
                    const tangentAngle = angle - Math.PI / 2;
                    
                    const arrowLength = i === 1 ? 35 : 30;
                    const x2 = x1 + arrowLength * Math.cos(tangentAngle);
                    const y2 = y1 + arrowLength * Math.sin(tangentAngle);
                    
                    const intensity = current / (i * 0.5);
                    if (intensity > 0.1) {
                        const color = i === 1 ? '#2980b9' : '#3498db';
                        drawArrow(ampereCtx, x1, y1, x2, y2, color);
                    }
                }
                
                // Label the innermost circle
                if (i === 1) {
                    ampereCtx.fillStyle = '#2980b9';
                    ampereCtx.font = 'bold 16px Arial';
                    ampereCtx.textAlign = 'center';
                    const labelAngle = Math.PI / 4;
                    const labelX = cx + (radius + 30) * Math.cos(labelAngle);
                    const labelY = cy + (radius + 30) * Math.sin(labelAngle);
                    ampereCtx.fillText('B field', labelX, labelY);
                }
            }
            
            // Draw displacement current visualization (if enabled)
            if (eChangeRate > 0) {
                const eField = Math.sin(ampereTime * 2) * eChangeRate;
                const eRegionSize = 140;
                
                ampereCtx.save();
                ampereCtx.translate(width - 180, height - 150);
                
                // Background box
                ampereCtx.fillStyle = 'rgba(231, 76, 60, 0.1)';
                ampereCtx.fillRect(-eRegionSize/2, -eRegionSize/2, eRegionSize, eRegionSize);
                
                ampereCtx.strokeStyle = '#e74c3c';
                ampereCtx.lineWidth = 2;
                ampereCtx.strokeRect(-eRegionSize/2, -eRegionSize/2, eRegionSize, eRegionSize);
                
                // E field arrows (changing with time)
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        const x = i * 40;
                        const y = j * 40;
                        const arrowLen = 15 * Math.abs(eField);
                        if (eField > 0) {
                            drawArrow(ampereCtx, x, y - arrowLen, x, y + arrowLen, '#e74c3c');
                        } else if (eField < 0) {
                            drawArrow(ampereCtx, x, y + arrowLen, x, y - arrowLen, '#e74c3c');
                        }
                    }
                }
                
                ampereCtx.fillStyle = '#e74c3c';
                ampereCtx.font = 'bold 14px Arial';
                ampereCtx.textAlign = 'center';
                ampereCtx.fillText('Displacement', 0, -eRegionSize/2 - 15);
                ampereCtx.fillText('Current ‚àÇE/‚àÇt', 0, eRegionSize/2 + 25);
                
                ampereCtx.restore();
            }
            
            // Draw right-hand rule illustration
            ampereCtx.save();
            ampereCtx.translate(80, height - 140);
            
            // Box background
            ampereCtx.fillStyle = 'rgba(241, 196, 15, 0.1)';
            ampereCtx.fillRect(0, 0, 200, 120);
            ampereCtx.strokeStyle = '#f1c40f';
            ampereCtx.lineWidth = 2;
            ampereCtx.strokeRect(0, 0, 200, 120);
            
            // Right hand illustration
            ampereCtx.fillStyle = '#333';
            ampereCtx.font = 'bold 14px Arial';
            ampereCtx.textAlign = 'left';
            ampereCtx.fillText('Right-Hand Rule:', 10, 25);
            
            ampereCtx.font = '13px Arial';
            ampereCtx.fillStyle = '#f39c12';
            ampereCtx.fillText('üëç Thumb ‚Üí Current I', 10, 50);
            ampereCtx.fillText('   (points INTO page ‚äó)', 10, 68);
            
            ampereCtx.fillStyle = '#3498db';
            ampereCtx.fillText('‚úã Fingers ‚Üí B field', 10, 93);
            ampereCtx.fillText('   (curl CLOCKWISE ‚Üª)', 10, 111);
            
            ampereCtx.restore();
            
            // Add directional labels on the diagram
            ampereCtx.fillStyle = '#2980b9';
            ampereCtx.font = 'bold 18px Arial';
            ampereCtx.textAlign = 'center';
            
            // Top
            ampereCtx.fillText('‚Üí', cx, cy - 150);
            // Right
            ampereCtx.fillText('‚Üì', cx + 150, cy);
            // Bottom
            ampereCtx.fillText('‚Üê', cx, cy + 160);
            // Left
            ampereCtx.fillText('‚Üë', cx - 150, cy);
            
            // Add "CLOCKWISE" label
            ampereCtx.fillStyle = '#2980b9';
            ampereCtx.font = 'bold 16px Arial';
            ampereCtx.fillText('CLOCKWISE ‚Üª', cx + 180, cy - 80);
            
            if (ampereRunning && animationRunning) {
                ampereTime += 0.02;
            }
            requestAnimationFrame(drawAmpereDetail);
        }

        function toggleAmpere() {
            ampereRunning = !ampereRunning;
        }

        // Initialize
        updateEquations();
        drawWave();
        drawMaxwell();
        drawFaradayDetail();
        drawAmpereDetail();
    </script>
</body>
</html>